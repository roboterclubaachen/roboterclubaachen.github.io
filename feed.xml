<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Roboterclub Aachen</title>
        <atom:link href="/feed.xml" rel="self" type="application/rss+xml"/>
        <link>http://www.roboterclub.rwth-aachen.de/</link>
        <description></description>
        <pubDate>Thu, 22 Jul 2021 22:59:12 +0000</pubDate>
        
        <item>
            <title>µMotor 2 - Teil 4: Strom- und Spannungsmessung mit ADC</title>
            <link>/blog/2020/micro-motor-2-teil-4.html</link>
            <guid isPermaLink="true">/blog/2020/micro-motor-2-teil-4.html</guid>
            <description>&lt;p&gt;Over the past few weeks, a circuit diagram for the Micro-moto version 2 has been created from the previous considerations.
After some productive reviews and discussions about the schematic and the incorporation of various improvements and changes, a board layout was drawn in KiCad.&lt;/p&gt;

&lt;p&gt;The production of the board was sponsored by Aisler and after only about a week of waiting the boards and all components arrived in our lab.&lt;/p&gt;

&lt;p&gt;Quickly two boards were assembled and except for one single solder bridge successfully soldered in the reflow oven.
Only the (optional) vertical Micro-USB connector had been forgotten when ordering the components, but this was no problem, since programming via SWD is more convenient for testing due to its debugger interface.&lt;/p&gt;

&lt;p&gt;Step by step, power supply, STM32 microcontroller, status LEDs and gate drivers including MOSFET power stage were tested successfully. Everything worked on the first try, for once.&lt;/p&gt;

&lt;p&gt;The development process of the micro-motor can be followed up &lt;a href=&quot;/blog/2019/micro-motor-2-teil-3.html&quot;&gt;in&lt;/a&gt; &lt;a href=&quot;/blog/2019/micro-motor-2-teil-2.html&quot;&gt;several&lt;/a&gt; &lt;a href=&quot;/blog/2019/micro-motor-2-teil-1.html&quot;&gt;older&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-debugging-inbetriebnahme.html&quot;&gt;blog posts&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The next step is to bring the current and voltage measurement into operation.
For this purpose we document in this blog post the requirements and development of the implementation with the analog-to-digital converter of the STM32G4 microcontroller.&lt;/p&gt;

&lt;h2 id=&quot;requirements&quot;&gt;Requirements&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ADC sampling synchronous to PWM of motor (approx. 100kHz)&lt;/li&gt;
  &lt;li&gt;Sampling on every PWM cycle&lt;/li&gt;
  &lt;li&gt;For all phases either current or voltage are measured: current on both “switched” phases, voltage on the “high-impedance” phase&lt;/li&gt;
  &lt;li&gt;Measure current in both phases simultaneously&lt;/li&gt;
  &lt;li&gt;Additional ADC measurements at low priority and with low frequency
    &lt;ul&gt;
      &lt;li&gt;Motor supply voltage&lt;/li&gt;
      &lt;li&gt;3.3V supply voltage (Vbat)&lt;/li&gt;
      &lt;li&gt;NTC temperature sensor&lt;/li&gt;
      &lt;li&gt;Internal temperature&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;adc-channel-usage-on-the-micro-motor&quot;&gt;ADC channel usage on the micro-motor&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Measurement&lt;/th&gt;
      &lt;th&gt;Possible ADC channels&lt;/th&gt;
      &lt;th&gt;Gpio pin&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Current U&lt;/td&gt;
      &lt;td&gt;Adc1Ch1, Adc2Ch1&lt;/td&gt;
      &lt;td&gt;GpioA0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Current V&lt;/td&gt;
      &lt;td&gt;Adc1Ch2, Adc2Ch2&lt;/td&gt;
      &lt;td&gt;GpioA1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Current W&lt;/td&gt;
      &lt;td&gt;Adc1Ch4&lt;/td&gt;
      &lt;td&gt;GpioA3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Voltage U&lt;/td&gt;
      &lt;td&gt;Adc1Ch15, Adc3Ch12&lt;/td&gt;
      &lt;td&gt;GpioB0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Voltage V&lt;/td&gt;
      &lt;td&gt;Adc2Ch4&lt;/td&gt;
      &lt;td&gt;GpioA7&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Voltage W&lt;/td&gt;
      &lt;td&gt;Adc2Ch3&lt;/td&gt;
      &lt;td&gt;GpioA6&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Motor supply voltage&lt;/td&gt;
      &lt;td&gt;Adc2Ch12&lt;/td&gt;
      &lt;td&gt;GpioB2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;3.3V supply voltage&lt;/td&gt;
      &lt;td&gt;Adc1Ch17, Adc3Ch17&lt;/td&gt;
      &lt;td&gt;N/A&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;NTC temperature sensor&lt;/td&gt;
      &lt;td&gt;Adc1Ch12, Adc3Ch1&lt;/td&gt;
      &lt;td&gt;GpioB1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Internal temperature&lt;/td&gt;
      &lt;td&gt;Adc1Ch16, Adc5Ch4&lt;/td&gt;
      &lt;td&gt;N/A&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;implementation&quot;&gt;Implementation&lt;/h2&gt;

&lt;p&gt;The three critical measurements will be sequenced as “Injected Conversions” and triggered by a event generated from the timer which generates the Motor-PWM.&lt;/p&gt;

&lt;p&gt;In an “Injected conversions sequence” (sequence length is limited to 4) each conversion has its own output data register.
Thus all conversion results can be easily read one after the other in the time until the next PWM cycle and no interrupts are needed.&lt;/p&gt;

&lt;p&gt;For every of the six valid commutation steps that define the state of the three MOSFET half bridges, a mapping to the ADC channels is predefined and applied during the commutation.&lt;/p&gt;

&lt;p&gt;Low-Priority measurements are sequenced in the ADCs “normal-mode” sequence and are triggered at a lower frequency (by another timer or manually from code).&lt;/p&gt;
</description>
            <pubDate>Fri, 31 Jan 2020 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>! W A N T E D ! - Einsteiger</title>
            <link>/blog/2019/wanted-einsteiger.html</link>
            <guid isPermaLink="true">/blog/2019/wanted-einsteiger.html</guid>
            <description>&lt;h2 id=&quot;du-willst-bei-uns-mitmachen-super&quot;&gt;Du willst bei uns mitmachen? Super!&lt;/h2&gt;

&lt;p&gt;Für die kommende Eurobot-Wettbewerbs-Saison gibt es viel zu tun im
Roboterclub und wir freuen uns, wenn du dich in einem der folgenden
Bereichen engagieren möchtest:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Bildverarbeitung&lt;/li&gt;
  &lt;li&gt;Funk-Kommunikation&lt;/li&gt;
  &lt;li&gt;Mechanische Aktoren zum Greifen von Bechern&lt;/li&gt;
  &lt;li&gt;Antriebs-Plattform (Omnidrive)&lt;/li&gt;
  &lt;li&gt;Regelung und Fahrtplanung&lt;/li&gt;
  &lt;li&gt;Mechanische Fertigung (3D-Drucker und CNC-Fräse)&lt;/li&gt;
  &lt;li&gt;Batterie-Management&lt;/li&gt;
  &lt;li&gt;Motor-Controller&lt;/li&gt;
  &lt;li&gt;Autonome Roboter-Steuerung mit ROS2&lt;/li&gt;
  &lt;li&gt;Ultraschall-Indoor-Lokalisierung&lt;/li&gt;
  &lt;li&gt;…&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Um dir einen guten Einstieg zu ermöglichen findet am&lt;/p&gt;

&lt;h4 id=&quot;dienstag-den-29102019-um-19h&quot;&gt;Dienstag, den 29.10.2019 um 19h&lt;/h4&gt;

&lt;p&gt;ein Einsteiger-Event statt.
Dort zeigen wir dir unser Roboter und Projekte, und vermitteln dir eine
Aufgabe oder ein Projekt im RCA.&lt;/p&gt;

&lt;h3 id=&quot;weitere-information-unter-mach-mit&quot;&gt;Weitere Information unter: &lt;a href=&quot;/mach-mit/&quot;&gt;Mach mit&lt;/a&gt;&lt;/h3&gt;
</description>
            <pubDate>Mon, 21 Oct 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>µMotor 2 - Teil 3: Microcontroller &amp; Stromversorgung</title>
            <link>/blog/2019/micro-motor-2-teil-3.html</link>
            <guid isPermaLink="true">/blog/2019/micro-motor-2-teil-3.html</guid>
            <description>&lt;p&gt;Als Teil der Entwicklung der zweiten Version des Micro-Motors findet nun die Auswahl des Microcontrollers statt.
Außerdem geht es in diesem Blogpost um Komparatoren und die Stromversorgung.&lt;/p&gt;

&lt;p&gt;Die bisherige Entwicklung des Motorcontrollers kann in &lt;a href=&quot;/blog/2019/micro-motor-2-teil-2.html&quot;&gt;mehreren&lt;/a&gt; &lt;a href=&quot;/blog/2019/micro-motor-2-teil-1.html&quot;&gt;älteren&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-debugging-inbetriebnahme.html&quot;&gt;Blogposts&lt;/a&gt; nachgelesen werden.&lt;/p&gt;

&lt;p&gt;Die vorläufige Auswahl der Shuntverstärker ist fast abgeschlossen, siehe &lt;a href=&quot;/blog/2019/micro-motor-2-teil-2.html&quot;&gt;Teil 2&lt;/a&gt;.
Ebenso ist der Gatetreiber (&lt;em&gt;DRV832x&lt;/em&gt;) gesetzt in der Version ohne Strommessverstärker und mit SPI-Interface (&lt;em&gt;DRV8320S&lt;/em&gt; oder &lt;em&gt;DRV8350S&lt;/em&gt; in Gehäuse &lt;em&gt;WQFN32&lt;/em&gt;, 5x5mm²).
Also MOSFET soll der in Micro-Motor Version 1 bewährte N-Channel Dual-FET &lt;em&gt;FDMD8260L&lt;/em&gt; (60V, 5.8mΩ) verwendet werden.&lt;/p&gt;

&lt;p&gt;Als nächste wichtige Komponente wird der Microcontroller ausgewählt.&lt;/p&gt;

&lt;h3 id=&quot;microcontroller&quot;&gt;Microcontroller&lt;/h3&gt;

&lt;p&gt;Eher zufällig wurden wir auf die neue Microcontroller-Serie &lt;em&gt;STM32G4&lt;/em&gt; von ST Microelectronics aufmerksam.
In &lt;a href=&quot;/blog/2019/micro-motor-2-teil-1.html&quot;&gt;Teil 1&lt;/a&gt; wurde der &lt;em&gt;STM32L432CC&lt;/em&gt; als präferierter Microcontroller genannt, jedoch bietet die neue &lt;em&gt;STM32G4&lt;/em&gt;-Serie, speziell der &lt;em&gt;STM32G474&lt;/em&gt; (oder &lt;em&gt;STM32G473&lt;/em&gt;, ohne High-Resolution-Timer) einige Vorteile:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Taktfreqenz bis zu 170MHz für Cortex-M4F und &lt;strong&gt;alle&lt;/strong&gt; Peripherals (max. 80MHz bei &lt;em&gt;STM32L4&lt;/em&gt;)&lt;/li&gt;
  &lt;li&gt;High-Performance Analog Peripherals
    &lt;ul&gt;
      &lt;li&gt;7x Komparator (&lt;em&gt;COMP&lt;/em&gt;), 17ns Propagation delay, einstellbare Hysterese&lt;/li&gt;
      &lt;li&gt;5x ADC 12bit, 4MSPS, differenzielle Inputs verfügbar)&lt;/li&gt;
      &lt;li&gt;4x DAC 12bit, 1MSPS&lt;/li&gt;
      &lt;li&gt;6x Opamp mit GBP (Gain Bandwidth Product) von 13MHz (&lt;em&gt;OPAMP&lt;/em&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;DSP (Rechenbeschleuniger) Funktionen für Trigonometrie und Filter (&lt;em&gt;CORDIC&lt;/em&gt;, &lt;em&gt;FMAC&lt;/em&gt;)&lt;/li&gt;
  &lt;li&gt;High-Resolution-Timer (&lt;em&gt;HRTIM&lt;/em&gt;) mit 184ps Zeitauslösung&lt;/li&gt;
  &lt;li&gt;3x Advanced Motor Control Timer (&lt;em&gt;TIM1&lt;/em&gt;, &lt;em&gt;TIM8&lt;/em&gt;, &lt;em&gt;TIM20&lt;/em&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Die folgenden Bilder zeigen die für den Micro-Motor relevanten Features der &lt;em&gt;STM32G4&lt;/em&gt;-Serie und stammen aus STs Präsentation “STM32G4 Mainstream MCUs Product Overview”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/microcontrollers_STM32G4_series_product_overview__p10.png&quot; alt=&quot;Microcontrollers_STM32G4_series_product_overview.pdf, Seite 10&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/microcontrollers_STM32G4_series_product_overview__p11.png&quot; alt=&quot;Microcontrollers_STM32G4_series_product_overview.pdf, Seite 11&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;small&gt;Quelle: &lt;a href=&quot;https://www.st.com/resource/en/product_presentation/microcontrollers_stm32g4_series_product_overview.pdf&quot;&gt;https://www.st.com/resource/en/product_presentation/microcontrollers_stm32g4_series_product_overview.pdf&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Stand 2019/08 sind nur einige wenige Chips aus der &lt;em&gt;STM32G4&lt;/em&gt;-Serie verfügbar, für den Micro-Motor kommen &lt;a href=&quot;https://octopart.com/search?q=STM32G474CET6&quot;&gt;&lt;em&gt;STM32G474CET6&lt;/em&gt;&lt;/a&gt; und &lt;a href=&quot;https://octopart.com/search?q=STM32G473CET6&quot;&gt;&lt;em&gt;STM32G473CET6&lt;/em&gt;&lt;/a&gt; im &lt;em&gt;LQFP48&lt;/em&gt; Gehäuse in Frage.
Im vom &lt;em&gt;STM32L433CCU&lt;/em&gt; bekannten Gehäuse &lt;em&gt;UFQFPN48&lt;/em&gt; stehen noch keine Chips zu Verfügung.
Das Gehäuse &lt;em&gt;LQFP48&lt;/em&gt; benötigt zwar mehr Platinenoberfläche als der &lt;em&gt;UFQFPN48&lt;/em&gt;, allerdings sind bei letztem Gehäuse durch das Exposed Pad keine Durchkontaktierungen und Leiterbahnen unterhalb des Chips möglich, was den Platzvorteil unter Umständen aufwiegt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/CubeMX_screenshot_STM32G474CE_201909.png&quot; alt=&quot;Mögliches Pinout des Microcontrollers STMG474CE, Screenshot aus ST CubeMX Software&quot; /&gt;&lt;/p&gt;
&lt;center&gt;&lt;small&gt;Mögliches Pinout des Microcontrollers &lt;i&gt;STM32G474CE&lt;/i&gt;, Screenshot aus ST CubeMX Software.&lt;/small&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Erfreulicherweise können die ADC- und Komparator-Eingänge zeitgleich genutzt werden, sodass hier keine unnötigen Pins verschwendet werden müssen.&lt;/p&gt;

&lt;h3 id=&quot;komparator&quot;&gt;Komparator&lt;/h3&gt;

&lt;p&gt;Da der Komparator im Microcontroller integriert ist, werden keine dedizierten Komparatoren benötigt.
Das spart viel Platz und reduziert die Komplexität des Platinenlayouts.&lt;/p&gt;

&lt;h3 id=&quot;systemüberblick&quot;&gt;Systemüberblick&lt;/h3&gt;

&lt;p&gt;Durch die geänderte Auswahl des Microcontrollers ändert sich das Blockschaltbild geringfügig.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/Micro-Motor-V2-Block-diagram_201909.svg&quot; alt=&quot;Micro-Motor V2 Blockdiagram, aktualisiert 2019/09&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;stromversorgung&quot;&gt;Stromversorgung&lt;/h3&gt;

&lt;p&gt;Die Logik, bzw. alle Komponenten außer den MOSFET-Halb-Brücken und dem Motor, werden über eine separate Spannungsschiene im Roboter mit 6V bis 7V versorgt.
Aus diesen 6V bis 7V müssen lokal 3.3V für den Microcontroller und weitere Elektronik, sowie 5V für Hall-Sensoren und Encoder erzeugt werden.
Die Logik-Versorgungsspannung bleibt im Gegensatz zu Versorgungsspannung für den Motor bei einem Not-Aus bestehen.&lt;/p&gt;

&lt;p&gt;Um alle Komponenten auch ungünstigsten Situationen stabil mit Strom zu versorgen sind sowohl für 3.3V als auch für 5V Spannungsregler mit eine Ausgangsstrom von mindestens 200mA nötig.
Beispielsweise der CAN-Transceiver &lt;em&gt;TCAN332&lt;/em&gt; kann bei einem Bus Fault bis zu 180mA benötigen, auch in diesem Fall muss der Betrieb des Micro-Motors aufrecht erhalten werden.&lt;/p&gt;

&lt;p&gt;Der Gatetreiber &lt;em&gt;DRV832x&lt;/em&gt;/&lt;em&gt;DRV835x&lt;/em&gt; ist mit dem Suffix &lt;em&gt;R&lt;/em&gt; erhaltlich, wo ein Schaltregler galvanisch getrennt ins das Gehäuse integriert ist.
Beim &lt;em&gt;DRV832x&lt;/em&gt; handelt es sich um den Buck-Regulator &lt;a href=&quot;http://www.ti.com/product/LMR16006&quot;&gt;LMR16006X&lt;/a&gt;, welcher bei Eingangsspannugen zwischen 4V und 60V ein Spannung zwischen 0,8V bis 60V bei 600mA bereitstellen kann.
Der in den &lt;em&gt;DRV835x&lt;/em&gt; integrierte Buck-Regler &lt;a href=&quot;http://www.ti.com/product/LM5008A&quot;&gt;LM5008A&lt;/a&gt; liefert 2.5V bis 75V bei 350mA bei Eingangsspannugen zwischen 6V und 95V.
Statt im &lt;em&gt;WQFN32&lt;/em&gt; (5x5mm²) Gehäuse kommt der Gatetreiber dann im &lt;em&gt;WQFN40&lt;/em&gt; (6x6mm²) Gehäuse, benötigt also 11mm² mehr Platinenfläche zuzüglich der externen Spule, Kondensatoren und Widerständen.&lt;/p&gt;

&lt;p&gt;Das hochintegrierte Schaltwandler-Modul &lt;a href=&quot;http://www.ti.com/product/TPS82150&quot;&gt;TPS82150&lt;/a&gt; hat eine integrierte Spule und benötigt im &lt;em&gt;μSiL8&lt;/em&gt; Gehäuse lediglich 8.4mm² Platinenfläche.
Zudem kann ein besseres Platinenlayout durch die flexible Platzierung ermöglicht werden.&lt;/p&gt;

&lt;p&gt;Für die Versorgung der empfindlichen analogen Elektronik könnte ein dedizierter LDO-Wandler hinter dem 5V Schaltwandler eingesetzt werden, fall ein LC-Filter eine ausreichend rauschfreie Spannungsversorgung ermöglicht.&lt;/p&gt;

&lt;h4 id=&quot;rekuperation&quot;&gt;Rekuperation&lt;/h4&gt;

&lt;p&gt;Mit Hilfe von Rekuperation kann sowohl die Wärmeentwicklung im Micro-Motor, als auch die Batterie-Laufzeit des gesamten Roboters verbessert werden.
Eine Begrenzung der Rekuperationsleistung im Micro-Motor ist nicht vorgesehen, da dies zentral im BMS besser lösbar ist.&lt;/p&gt;

&lt;h4 id=&quot;überspannungsschutz&quot;&gt;Überspannungsschutz&lt;/h4&gt;

&lt;p&gt;TVS-Dioden an dem Logik- und Motor-Versorgungsspannungen müssen so ausgelegt werden, dass die auf Micro-Motor vorhandenen Spannungsregler bzw. andere direkt verbundenen Bauteile nicht beschädigt werden können.
Um Rekuperation mit hoher Effizienz zu ermöglichen sollte die Clamping Voltage so hoch wie möglich gewählt werden.&lt;/p&gt;
</description>
            <pubDate>Mon, 02 Sep 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>µMotor 2 - Teil 2: Strommessung</title>
            <link>/blog/2019/micro-motor-2-teil-2.html</link>
            <guid isPermaLink="true">/blog/2019/micro-motor-2-teil-2.html</guid>
            <description>&lt;p&gt;In diesem Blogpost geht es um die Weiterentwicklung des Motorcontrollers “Micro-Motor” zur Version 2.
Die bisherige Entwicklung des Motorcontrollers kann in &lt;a href=&quot;/blog/2019/micro-motor-2-teil-1.html&quot;&gt;mehreren&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-debugging-inbetriebnahme.html&quot;&gt;älteren&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-motorcontroller.html&quot;&gt;Blogposts&lt;/a&gt; nachgelesen werden.&lt;/p&gt;

&lt;p&gt;Von den im &lt;a href=&quot;/blog/2019/micro-motor-2-teil-1.html&quot;&gt;vorherigen Blog-Post&lt;/a&gt; aufgelisteten Shuntverstärkern sind die beiden Bauteile von Analog Devices (ehem. Linear Technologie) und Texas Instruments in die nähere Auswahl gekommen.
Es wurden von TIs INA240 Muster bestellt mit Gain 50 und 200, sowie Gain 20 und 50 beim LT1999, da bei diesem keine Variante mit Gain über 50 verfügbar ist.&lt;/p&gt;

&lt;p&gt;Als Shunt dient ein 5mΩ 1W 1% SMD-Widerstand in Baugröße 0805 (&lt;a href=&quot;https://octopart.com/tlr2attd5l00f-koa+speer-27701192&quot;&gt;KOA Speer TLR2ATTD5L00F&lt;/a&gt;).
Durch die kleine Bauform ist ein kompakter Aufbau gewährleistet, wie in den Datenblättern empfohlen (&lt;a href=&quot;https://www.analog.com/media/en/technical-documentation/data-sheets/1999fd.pdf&quot;&gt;LT1999&lt;/a&gt; Seite 16 bzw. &lt;a href=&quot;http://www.ti.com/lit/ds/symlink/ina240.pdf&quot;&gt;INA240&lt;/a&gt; Seite 27).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/Versuchsaufbau-LT1999.jpg&quot; alt=&quot;Shuntverstärker Versuchsaufbau&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Der weitere Messaufbau besteht aus einem &lt;a href=&quot;/blog/2019/alpha-motor-description.html&quot;&gt;Motor-Controller&lt;/a&gt; über welchen Frequenz und Duty-Cycle eingestellt werden können.
Als Last dient ein 2kW Lastwiderstand mit 9,4Ω nach Ground, wodurch ein Strom von maximal 2,1A bei 20V durch den Shunt fließen.
Die Induktivität des Aufbaus ist leider nicht bekannt, das keine geeigenten Messgeräte zur Verfügung standen.&lt;/p&gt;

&lt;p&gt;An den folgenden Messungen ist leicht zu erkennen, dass der LT1999 in unserem Fall ungeeignet zur Strommessung In-Phase ist.
Der durch die Common-Mode-Spannungsänderung erzeugte Spike am Ausgang ist größer als das erwartete Mess-Signal,
gerade bei kleinen Duty-Cycles (&amp;lt;10%) verschwindet der Messwert hier vollständig.&lt;/p&gt;

&lt;p&gt;Der Shuntverstärker INA240 eignet zur Strommessung In-Phase, hier ist kein störender Einfluss der Common-Mode-PWM-Signals auf den Ausgang zu beobachten.
Die Variante INA240A4 mit Gain 200 kann mit einem 5mΩ Shuntwiderstand nur etwa 2A messen, der Messbereich von 10A beim INA240A2 (Gain 50) ist für den Motorcontroller besser geeignet.
Denkbar wäre es natürlich auch einen kleineren Shuntwiderstand zu wählen, jedoch würde dies aufgrund von stärkeren Einkoppplungen wahrscheinlich schlechtere Ergebnisse liefern.&lt;/p&gt;

&lt;p&gt;Auf den Osziloskop-Bildern ist in Gelb der Ausgang des Shuntverstärkers zu sehen.
Auf Kanal 2 (Blau) ist die Spannung an der Motor-Phase beziehungsweise über dem Last-Widerstand dargestellt.&lt;/p&gt;

&lt;h2 id=&quot;duty-cycle-30&quot;&gt;Duty-Cycle 30%&lt;/h2&gt;

&lt;h3 id=&quot;in-phase&quot;&gt;In-Phase&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-20_In-Phase_160kHz_0uH.jpg&quot; alt=&quot;Shuntverstärker Messung: LT1999, Gain 20, In-Phase, 160kHz, 0µH&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 20, In-Phase, 160kHz, 0µH&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_In-Phase_160kHz_0uH.jpg&quot; alt=&quot;Shuntverstärker Messung: LT1999, Gain 50, In-Phase, 160kHz, 0µH&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 50, In-Phase, 160kHz, 0µH&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_In-Phase_160kHz-30.bmp&quot; alt=&quot;INA240A2, Gain 50, In-Phase, 160kHz, 30%, (negativer Ausschlag, 20V)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, In-Phase, 160kHz, 30%, (negativer Ausschlag, 20V)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_In-Phase_160kHz-30_12V.bmp&quot; alt=&quot;INA240A2, Gain 50, In-Phase, 160kHz, 30%, (negativer Ausschlag, 12V -&amp;gt; 1A)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, In-Phase, 160kHz, 30%, (negativer Ausschlag, 12V -&amp;gt; 1A)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_In-Phase_160kHz-30_12V.bmp&quot; alt=&quot;INA240A4, Gain 200, In-Phase, 160kHz (negativer Ausschlag, 12V -&amp;gt; 1A)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, In-Phase, 160kHz (negativer Ausschlag, 12V -&amp;gt; 1A)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_In-Phase_160kHz-30.bmp&quot; alt=&quot;INA240A4, Gain 200, In-Phase, 160kHz (negativer Ausschlag)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, In-Phase, 160kHz (negativer Ausschlag)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;!--
![Shuntverstärker Messung: LT1999, Gain 50, In-Phase, 160kHz, 0µH](../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_In-Phase_160kHz.jpg)
&lt;center&gt;LT1999, Gain 50, In-Phase, 160kHz, 0µH&lt;/center&gt;&lt;br /&gt;

![Shuntverstärker Messung: LT1999, Gain 50, In-Phase, 80kHz, 0µH](../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_In-Phase_80kHz.jpg)
&lt;center&gt;LT1999, Gain 50, In-Phase, 80kHz, 0µH&lt;/center&gt;&lt;br /&gt;
--&gt;

&lt;h3 id=&quot;low-side&quot;&gt;Low-Side&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-20_Low-Side_160kHz_0uH.jpg&quot; alt=&quot;Shuntverstärker Messung: LT1999, Gain 20, Low-Side, 160kHz, 0µH&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 20, Low-Side, 160kHz, 0µH&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_Low-Side_160kHz.jpg&quot; alt=&quot;Shuntverstärker Messung: LT1999, Gain 50, Low-Side, 160kHz, 0µH&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 50, Low-Side, 160kHz, 0µH&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_Low-Side_160kHz-30.bmp&quot; alt=&quot;INA240A2, Gain 50, Low-Side, 160kHz, 30%, (positiver Ausschlag, 20V)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, Low-Side, 160kHz, 30%, (positiver Ausschlag, 20V)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_Low-Side_160kHz-30_12V.bmp&quot; alt=&quot;INA240A2, Gain 50, Low-Side, 160kHz, 30%, (positiver Ausschlag, 12V -&amp;gt; 1A)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, Low-Side, 160kHz, 30%, (positiver Ausschlag, 12V -&amp;gt; 1A)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_Low-Side_160kHz-30_12V.bmp&quot; alt=&quot;INA240A4, Gain 200, Low-Side, 160kHz (positiver Ausschlag, 12V -&amp;gt; 1A)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, Low-Side, 160kHz (positiver Ausschlag, 12V -&amp;gt; 1A)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_Low-Side_160kHz-30.bmp&quot; alt=&quot;INA240A4, Gain 200, Low-Side, 160kHz (positiver Ausschlag)&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, Low-Side, 160kHz (positiver Ausschlag)&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;!--
![Shuntverstärker Messung: LT1999, Gain 50, Low-Side, 160kHz, 10µH](../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_Low-Side_160kHz_10uH.jpg)
&lt;center&gt;LT1999, Gain 50, Low-Side, 160kHz, 10µH&lt;/center&gt;&lt;br /&gt;

![Shuntverstärker Messung: LT1999, Gain 50, In-Phase, 160kHz, 10µH](../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_In-Phase_160kHz_10uH.jpg)
&lt;center&gt;LT1999, Gain 50, In-Phase, 160kHz, 10µH&lt;/center&gt;&lt;br /&gt;
--&gt;

&lt;h2 id=&quot;duty-cycle-5&quot;&gt;Duty-Cycle 5%&lt;/h2&gt;

&lt;h3 id=&quot;in-phase-1&quot;&gt;In-Phase&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-20_In-Phase_160kHz-5.bmp&quot; alt=&quot;LT1999, Gain 20, In-Phase&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 20, In-Phase&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_In-Phase_160kHz-5.bmp&quot; alt=&quot;LT1999, Gain 50, In-Phase&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 50, In-Phase&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_In-Phase_160kHz-5.bmp&quot; alt=&quot;INA240A2, Gain 50, In-Phase&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, In-Phase&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_In-Phase_160kHz-5.bmp&quot; alt=&quot;INA240A4, Gain 200, In-Phase&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, In-Phase&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h3 id=&quot;low-side-1&quot;&gt;Low-Side&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-20_Low-Side_160kHz-5.bmp&quot; alt=&quot;LT1999, Gain 20, Low-Side&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 20, Low-Side&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/LT1999-50_Low-Side_160kHz-5.bmp&quot; alt=&quot;LT1999, Gain 50, Low-Side&quot; /&gt;&lt;/p&gt;
&lt;center&gt;LT1999, Gain 50, Low-Side&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A2_Low-Side_160kHz-5.bmp&quot; alt=&quot;INA240A2, Gain 50, Low-Side&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A2, Gain 50, Low-Side&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/shuntverstaerker-messungen/INA240-A4_Low-Side_160kHz-5.bmp&quot; alt=&quot;INA240A4, Gain 200, Low-Side&quot; /&gt;&lt;/p&gt;
&lt;center&gt;INA240A4, Gain 200, Low-Side&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
</description>
            <pubDate>Fri, 30 Aug 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>µMotor 2 - Teil 1: Konzept</title>
            <link>/blog/2019/micro-motor-2-teil-1.html</link>
            <guid isPermaLink="true">/blog/2019/micro-motor-2-teil-1.html</guid>
            <description>&lt;p&gt;In diesem Blogpost geht es um die Weiterentwicklung des Motorcontrollers “Micro-Motor” zur Version 2.
Die bisherige Entwicklung des Motorcontrollers kann in &lt;a href=&quot;/blog/2019/alpha-motor-description.html&quot;&gt;mehreren&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-debugging-inbetriebnahme.html&quot;&gt;älteren&lt;/a&gt; &lt;a href=&quot;/blog/2018/micro-motor-motorcontroller.html&quot;&gt;Blogposts&lt;/a&gt; nachgelesen werden.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/micro-motor-faedeldraht.jpg&quot; alt=&quot;Makro-Aufnahme Micro-Motor Fädeldraht&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nachdem der einzige aufgebaute Prototyp des Micro-Motors beim Testen durch einen von einer Oszi-Probe verursachten Kurzschluss am Gatetreiber defekt war, wurde eine minimal modifizierte Schaltung als “Macro-Motor” auf einer größeren Platine aufgebaut um bequemer verschiedene Messungen durchführen zu können.&lt;/p&gt;

&lt;p&gt;Auch die Macro-Motor-Platine war leider nicht fehlerfrei. Unter anderem war leider der Footprint des neuen Spannungsreglers im WLCSP-6 (Wafer Level Chip Scale Package; 1x1,6mm²) spiegelverkehrt.
Ebenso war einer der beiden aufgebauten Prototypen nach dem Reflow-Löten nicht funktionsfähig, was auf durch von Hersteller zusätzlich verkleinerte Ausschnitte im Stencil verursachte zu geringe Menge an Lötpaste zurückzuführen war.
Beim Versuch die nicht verlöteten Pins des Gatetreiber-ICs von Hand nachzulöten ist dieser leider zerstört worden.&lt;/p&gt;

&lt;p&gt;Unabhängig von den bisher aufgetretenen Problemen sind neue Wünsche entstanden.
Für eine &lt;a href=&quot;/projekt/motor-commutation.html&quot;&gt;intelligente Motor-Kommutierung&lt;/a&gt; statt der bisher verwendeten stupiden Block-Kommutierung ist es teilweise nötig die Ström in den Phasen sowie auch die Spannung der Motorphasen zu messen.
Bessere Motor-Kommutierungen erlauben durch Sinus-förmige Ansteuerung mehr und gleichmäßigeres Drehmoment in sehr niedrigen Drehzahlbereichen zu erzeugen sowie auch Motoren ohne Hall-Sensoren anzusteuern.
Außerdem wurde in der Saison eine präzise und zuverlässige Strommessung sehnlichst vermisst, sodass auch diese ein erklärtes Ziel ist.&lt;/p&gt;

&lt;h3 id=&quot;systemüberblick&quot;&gt;Systemüberblick&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/micro-motor/Micro-Motor-V2-Block-diagram_201907.svg&quot; alt=&quot;Micro-Motor V2 Blockdiagram&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;komponentenauswahl&quot;&gt;Komponentenauswahl&lt;/h3&gt;

&lt;p&gt;Der Microcontroller wird nach bisheriger Planung ein STM32L433CCU im UFQFPN48 Gehäuse bleiben.&lt;/p&gt;

&lt;p&gt;Ebenso gibt es keinen Anlass den Gatetreiber &lt;a href=&quot;http://www.ti.com/product/DRV8323&quot;&gt;DRV8323S&lt;/a&gt; auszutauschen, da sich dieser durchgehend bewährt hat.
Es wird jedoch die Variante ohne integrierte Shuntverstärker verwendet, da die Shuntverstärker ein zu geringes Gain-Bandbreiten-Produkt aufweisen und keine präzise Strommessung zulassen.&lt;/p&gt;

&lt;p&gt;Die Spannungswandler werden für 5V und 3,3V werden durch &lt;a href=&quot;http://www.ti.com/product/TPS82150&quot;&gt;hochintegrierte Schaltwandler-Module&lt;/a&gt; ersetzt,
welche sich schon beim &lt;a href=&quot;/blog/2019/alpha-motor-description.html&quot;&gt;Alpha-Motor&lt;/a&gt; bewährt haben und auch für leistungshungrige Encoder oder Endschalter genügend Strom liefern kann.&lt;/p&gt;

&lt;p&gt;Der bisher vorgesehene I²C-Temperatursensor &lt;a href=&quot;http://www.ti.com/ww/eu/sensampbook/tmp006.pdf&quot;&gt;TMP006&lt;/a&gt; (nicht mehr verfügbar)
und die I²C-Anschlusspads für externe digitale Sensoren sollen durch einen analogen NTC-Temperatursensor ersetzt werden.
Ein NTC ist kompakter, günstiger, leichter am Motor zu befestigen und hat eine zur Überwachung der Motortemperatur ausreichende Genauigkeit.&lt;/p&gt;

&lt;h4 id=&quot;shuntverstärker-und-komparator&quot;&gt;Shuntverstärker und Komparator&lt;/h4&gt;

&lt;p&gt;Neu auf der Liste der Bauteile sind dedizierte Shuntverstärker und Komparatoren.
Hier müssen die verfügbaren Bauteile noch analysiert und verglichen werden.
Ein gutes Rennen bei den Shuntverstärkern liefert aktuell der &lt;a href=&quot;https://www.analog.com/en/products/lt1999.html&quot;&gt;LT1999&lt;/a&gt; von Analog ab.&lt;/p&gt;

&lt;p&gt;Da die Strommessung “inline” in den Motorphasen stattfindet muss der Shuntverstärker eine sehr hohe Gleichtaktunterdrückung aufweisen.
Gleichzeitig ist eine hohe Bandbreite von etwa 500 kHz bis 1 MHz gefordert um bei einer PWM-Frequenz noch brauchbare Messwerte zu liefern.
Die Gleichtaktspannung muss bis zu 24V betragen, außerdem ist neben einem hohen Gain, welcher die Verwendung von niederohmigen Shunt-Widerständen erlaubt, ein kleines Gehäuse gewünscht.&lt;/p&gt;

&lt;p&gt;Folgende Shuntverstärker stehen aktuell zur Auswahl:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.analog.com/media/en/technical-documentation/data-sheets/1999fd.pdf&quot;&gt;&lt;strong&gt;LT1999&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Gain: Fixed 10, 20 or 50 V/V&lt;/li&gt;
  &lt;li&gt;CMRR: &lt;strong&gt;&amp;gt;80dB @ 100kHz&lt;/strong&gt; (V_CM=0V, 7VP-P, f=100kHz); &amp;gt;96dB @ DC&lt;/li&gt;
  &lt;li&gt;Bandwidth: 2MHz&lt;/li&gt;
  &lt;li&gt;Package: MSOP-8&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;https://datasheets.maximintegrated.com/en/ds/MAX40056F-MAX40056U.pdf&quot;&gt;&lt;strong&gt;MAX40056&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Gain: Fixed 10, 20 or 50 V/V&lt;/li&gt;
  &lt;li&gt;CMRR: &lt;strong&gt;typ. 70dB @ 100kHz&lt;/strong&gt; (100mV_AC Sine, f=100kHz); &amp;gt;120dB @ DC&lt;/li&gt;
  &lt;li&gt;Bandwidth: 300kHz&lt;/li&gt;
  &lt;li&gt;Package: 2.02mm x 1.4mm WLP-8 and 8-pin μMAX&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://www.ti.com/lit/ds/symlink/ina240.pdf&quot;&gt;&lt;strong&gt;INA240&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Gain: Fixed 20, 50, 100 or 200 V/V&lt;/li&gt;
  &lt;li&gt;CMRR: &lt;strong&gt;typ. 93dB @ 50kHz&lt;/strong&gt; (f=50kHz); &amp;gt;120dB @ DC&lt;/li&gt;
  &lt;li&gt;Bandwidth: 400kHz&lt;/li&gt;
  &lt;li&gt;Package: TSSOP-8&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In den nächsten Wochen werden Samples dieser Chips unter den beim Micro-Motor herrschenden Umgebungsbedingungen getestet und dann ausgewählt.
Sollte sich keiner der verfügbaren Inline-Shuntverstärker als brauchbar erweisen, werden wir Low-Side-Shuntverstärker evaluieren.&lt;/p&gt;

&lt;h3 id=&quot;formfaktor&quot;&gt;Formfaktor&lt;/h3&gt;

&lt;p&gt;Im Gegensatz zur Version 1 wird für die zweite Version ein anderer Ansatz gewählt.
Der integrierte Magnet-Encoder fällt weg, stattdessen gibt es einen &lt;del&gt;gut lötbaren&lt;/del&gt; steckbaren Anschluss für externe Encoder&lt;del&gt;, sowohl einfach als auch mit differenziellen Signalen&lt;/del&gt;.
Da durch die kleine Bauform des Micromotors keine langen Kabel zum Encoder nötig sind, wird auf differenzielle Signale verzichtet.
Sollte ein Motor keinen integrierten Encoder haben, kann ein &lt;a href=&quot;https://github.com/roboterclubaachen/magnet-motor-encoder&quot;&gt;externer magnetischer Encoder&lt;/a&gt; auch über dieses Interface angeschlossen werden.&lt;/p&gt;

&lt;p&gt;Die Platine bekommt eine rechteckige Form und soll seitlich an den Motoren befestigt werden.
So lässt sich der Micro-Motor flexibler an einer Vielzahl von verschiedenen Motoren nutzen.
Die mechanischen Dimensionen werden sich kaum ändern, angepeilt ist eine Platinenfläche von weniger als 500mm², z.B. 15x25mm².
Dazu wird auch weiterhin eine beidseitige Bestückung notwendig sein.&lt;/p&gt;

&lt;h3 id=&quot;stecker&quot;&gt;Stecker&lt;/h3&gt;

&lt;p&gt;Um einen einfach Austausch der Platinen zu ermöglichen sollen keine Kabel fest auf der Platine verlötet werden.
Es werden sechs Steckverbindungen benötigt:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Motor-Anschluss (Phasen U, V, W), 3-polig, &amp;gt;=5A&lt;/li&gt;
  &lt;li&gt;Stromversorgung (20V, 6V und GND), 3-polig, &amp;gt;= 5A&lt;/li&gt;
  &lt;li&gt;CAN Kommunikation (CAN-H, CAN-L), 2- oder 3-polig&lt;/li&gt;
  &lt;li&gt;End-/Referenz-Schalter, 2- oder 3-polig&lt;/li&gt;
  &lt;li&gt;Hall-Sensor (Hall-Phasen U, V, W; GND und 5V/3.3V), 5-polig&lt;/li&gt;
  &lt;li&gt;Encoder (A, B, I; GND und 5/3.3V), 5-polig&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Für die leistungsführenden Steckverbinder soll 3-polige &lt;a href=&quot;https://jst.de/product-family/show/184/xh&quot;&gt;JST XH&lt;/a&gt; Stecker verwenden werden.
Diese sind bis 5A nutzbar, bei höhreren Strömen müssen die Kabel fest verlötet werden und Stecker ins Kabel integriert werden.&lt;/p&gt;

&lt;p&gt;Die Signalstecker sollen als 2-/3-polige und 5-polige &lt;a href=&quot;https://jst.de/product-family/show/89/gh&quot;&gt;JST GH&lt;/a&gt; Stecker ausgeführt werden.
Ebenso wie die Leistungsstecker mit 2.5mm Pitch sind diese die Stecker auch in SMT-Bauform erhältlich und bei einem Pitch von 1.25mm deutlich kompakter.&lt;/p&gt;

&lt;h3 id=&quot;weitere-entwicklung&quot;&gt;Weitere Entwicklung&lt;/h3&gt;

&lt;p&gt;Noch mehr Probleme und Verbesserungsvorschläge der ersten Revision sind im &lt;a href=&quot;https://github.com/roboterclubaachen/micro-motor/issues&quot;&gt;Github Issue #1&lt;/a&gt; aufgeführt.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Der Blog-Post wurde ursprünglich am 27.7.2019 verfasst und zuletzt am 18.8.2019 aktualisiert.&lt;/em&gt;&lt;/p&gt;
</description>
            <pubDate>Sun, 18 Aug 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>Review of Season 2019</title>
            <link>/blog/2019/Season-2019.html</link>
            <guid isPermaLink="true">/blog/2019/Season-2019.html</guid>
            <description>&lt;p&gt;This year’s topic in the Eurobot, organized by Planete Sciences from France, was Atom Factory.
In short, it was about manipulating ice hockypuks, the so-called atoms.
The tasks ranged from simply moving the atoms to grabbing, weighing and sorting them.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2019/eurobot-competition-2019.jpg&quot; alt=&quot;Eurobot competition 2019&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The preparations started in October 2018, with the publication of the new rules.
This years Season was mainly characterized by electrical engineering and software.
Due to a stronger generation change within our team, there was an enormous loss of knowledge about the technology of the previous years.
In order to become competitive again, new members were acquired and trained.
The resulting projects were then to flow into this year’s robot.
Together for example a new motor driver, our so-called Alphamotor, was developed, optimized and used.
The hurdles to be taken here were often not possible without hours of troubleshooting and improvements, which, however, had to be followed by a deeper examination of the matter.
Furthermore, a completely newly developed positioning system based on ultrasound was used for the first time.
This was developed together with a former member of the club and then integrated into our hardware abstraction and communication framework.
Meanwhile some of our robots software structure got a bigger rework, which seems to be not done yet&lt;/p&gt;

&lt;p&gt;But a lot has also changed mechanically in this season.
Thus a complex cartesian working gripper mechanism was designed and built, which can move to all positions necessary for the game with only one arm.
The well-proven drive concept was also replaced by an Omiwheel drivetrain for technical and practical reasons.
This makes it possible to drive in any direction without changing the alignment of the robot.
The necessary mathematical transformations as well as the implementation of these were also done in a very short time.
The result at the time of the competitions was a completely new construction, build by members, who compensated the loss of knowledge driven by outgoing members with the learning process during the season.
So the club is competitive again.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2019/eurobot-team-in-giessen.jpg&quot; alt=&quot;RCA Team im Gießen&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In the now following competitions we first went to Gießen from 02.05 to 04.05 this year, where the German preliminary decision for the international competition took place.
There, a total of 7 teams from all over Germany competed to reach the first to third place, for which the international competition will continue.
Fortunately our robot homologated and was ready for the competition.
Many sleepless nights and smoking heads should pay off, so our Team took the 2nd place behind TURAG from Dresden.
Thirdly, the Greenbirds team from Ludwigshafen managed to qualify for the international competition.
At the end of May we went from 29.05. to 01.06. to La Roche-Sur-Yon in France.
There the national and international competition with nearly 300 French teams took place.
The again best 3 teams from France were then also qualified for the international competition.
A total of 33 teams competed in the international competition.
It started with five preliminary rounds in which the aim was to collect the most points.
The best 8 teams from these preliminary rounds were then ready to enter the final.
Unfortunately, we had big problems with our new positioning system to reach defined points and even night-long improvements helped only little to change anything about it.
Therefore it was only enough for us to finish as 29th Team this year. The Eurobot was won by Team PMG Robotics from Serbia.
Despite the sobering result, the members are proud of what they achieved in the short time and motivated to give everything to win the Eurobot in the upcoming season.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2019/eurobot-team-in-france.jpg&quot; alt=&quot;RCA Team im La-Roche-sur-Yon&quot; /&gt;&lt;/p&gt;
</description>
            <pubDate>Thu, 25 Jul 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>Alpha-Motor: Ein neues Motorboard</title>
            <link>/blog/2019/alpha-motor-description.html</link>
            <guid isPermaLink="true">/blog/2019/alpha-motor-description.html</guid>
            <description>&lt;p&gt;In der Saison 2019 ist unsere Elektronik fast vollständig überarbeitet oder sogar neu entwickelt.
Eine der Neuentwicklungen ist unser neues Motorcontrol-Board, genannt Alpha-Motor.
Der Name bricht mit dem Schema, das vorher verwendet wurde: Auf den &lt;em&gt;iMotor&lt;/em&gt; folgte der &lt;em&gt;2Motor&lt;/em&gt;, wiederum gefolgt vom &lt;em&gt;3Motor&lt;/em&gt;.
Der Alpha-Motor kann anders als sein direkter Vorgänger nur zwei DC- oder BLDC-Motoren antreiben.
Dafür wurden mehrere Features hinzugefügt, die den Roboter leistungsfähiger und besser kontrollierbar machen.
Die wohl wichtigste Änderung betrifft die Ausgangsstufen.
Wo vorher vollintegrierte Chips verwendet wurden, sitzen nun simple Motortreiber-ICs (MIC4606), die Leistungstransistoren steuern.
Die Leistungsabgabe kann mit diesem simpleren Design verdoppelt werden, da Abwärme besser abgestrahlt wird. Für ein proof-of-concept der neuen Bauelemente wurde ein Testboard entwickelt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/alpha-motor/AlphaMotor_Testboard.jpg&quot; alt=&quot;Alpha-Motor Testboard&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Hier ist bereits zu sehen, dass die Ansteuerung nicht sehr komplex ist, da einfach ein Timer des Mikrocontrollers über drei komplementäre Ausgänge einen Motor steuern kann.
Die Verwendung einer SPI-Verbindung oder ähnlichem um mit den Endstufen zu kommunizieren entfällt.
Es ist jetzt noch leichter die Kontrolle zu behalten, da eine neue Strommessung für jeden Motor hinzugefügt wurde, die mit 1 MHz Abtastrate den Strom durch die Schaltbrücken begrenzen kann.
Der Spannungsabfall über einen Shunt-Widerstand wird in einem Komparator mit der frei verstellbaren Vorgabe verglichen und das Ergebnis auf den asynchronen Break-Input des Mikrocontrollers gegeben.
Das Ergebnis ist eine effektive Stromregelung.
Zusätzlich wird in jeweils zwei der drei Phasen die Stromstärke mit Hall-Sensoren gemessen, um eine sinusförmige Kommutierung statt einer einfacheren blöckförmigen zu ermöglichen.
Die Hauptaufgabe der Schaltung wird jetzt also besser erfüllt, ohne auf Funktionalität verzichten zu müssen.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/alpha-motor/AlphaMotor_Haupt.jpg&quot; alt=&quot;Alpha-Motor Platine&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Neben der Steuerung von Motoren, ist der Alpha-Motor wie sein Vorgänger das Gehirn des Roboters.
Über zwei CAN-Busse werden die Befehle vom Master-Board zu den Slaves geschickt und eine serielle Schnittstelle und einen SWD-Port (Serial-Wire-Debug) kommuniziert mit unserem Debugger, über den nicht nur Events geloggt werden können, sondern der Roboter auch over-the-air neue Software erhält.
Da weiterhin der gleiche Mikrocontroller verwendet wird, ist grundsätzlich die Verwendung zusammen mit älteren Boards möglich um im Notfall eine Ausweichmöglichkeit zu haben.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/alpha-motor/AlphaMotor_Antrieb.jpg&quot; alt=&quot;Antrieb mit Alpha-Motor Platinen im Roboter &amp;quot;Marie&amp;quot;&quot; /&gt;&lt;/p&gt;
</description>
            <pubDate>Thu, 09 May 2019 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>µMotor: Inbetriebnahme und Debugging</title>
            <link>/blog/2018/micro-motor-debugging-inbetriebnahme.html</link>
            <guid isPermaLink="true">/blog/2018/micro-motor-debugging-inbetriebnahme.html</guid>
            <description>&lt;p&gt;Die Idee zur Entwicklung des &lt;a href=&quot;/blog/2018/micro-motor-motorcontroller.html&quot;&gt;µMotors&lt;/a&gt; ist schon älter.
Damals, als die Auswahl der Komponenten noch geschah, wurde im RCA fast zeitgleich auch der größere Bruder des µMotors, der Alpha-Motor, entworfen.&lt;/p&gt;

&lt;p&gt;Beim Design der Leistungselektronik fiel die Wahl des MOSFET-Gatetreibers auf den &lt;a href=&quot;http://ww1.microchip.com/downloads/en/DeviceDoc/20005604B.pdf&quot;&gt;MIC4606&lt;/a&gt; in Kombination mit den &lt;a href=&quot;https://www.vishay.com/docs/68550/sqjb40ep.pdf&quot;&gt;SQJB40EP&lt;/a&gt; MOSFETs von Vishay.
(Vielen Dank an dieser Stelle an Vishay für das unkomplizierte und schnell zur Verfügung stellen von Samples.)&lt;/p&gt;

&lt;p&gt;Um die Eignung der ausgewählten Komponenten zu verifizieren wurde eine Testplatine entworfen, welche außerdem eine schöne und lehrreiche Aufgabe für zwei neue, bisher nicht mit dem Platinendesign vertrauten Mitgliedern des Roboterclubs darstellte.
Die Testplatine enthielt neben den MOSFET-Treibern und MOSFETs selbst nur Stecker, Testpunkte, die nötige passive Beschaltung aus Widerständen und Kondensatoren sowie die Spannungsversorgung.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/alpha-motor-testboard.jpg&quot; alt=&quot;Testplatine für MIC4606&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In Kombination mit einem Entwicklungs-Board für Microcontroller, in unserem Fall das [STM32F4Discovery], wurde die Ansteuerung von DC und BLDC Motoren erfolgreich getestet.&lt;/p&gt;

&lt;p&gt;Dadurch wurde der MIC4606 Chip für den Alpha-Motor ausgewählt und war auch für den Micro-Motor vorgesehen.
Im Laufe der weiteren Komponentenauswahl für den Micro-Motor stellten sich die mechanischen Dimensionen des Chips allerdings als zu groß heraus und der &lt;a href=&quot;http://www.ti.com/lit/ds/symlink/drv8323.pdf&quot;&gt;DRV8323&lt;/a&gt; Gate-Treiber bot einen insgesamt kleineren Footprint.
Der Chip selbst ist größer (6x6mm² WQFN zu 4x4mm² QFN), allerdings wird deutlich weniger externe Beschaltung (u.A. keine Gate-Serienwiderstände, keine Bootstrap-Kondensatoren) benötigt und drei Strommessverstärker sind direkt integriert.&lt;/p&gt;

&lt;p&gt;Der DRV8323 ist zugleich auch wesentlich komplexer als des MIC4606, statt einer &lt;a href=&quot;https://de.wikipedia.org/wiki/Bootstrapping_(Elektrotechnik)&quot;&gt;Bootstrap-Schaltung&lt;/a&gt; zur Ansteuerung der High-Side-MOSFETs integriert der Chip eine &lt;a href=&quot;https://de.wikipedia.org/wiki/Ladungspumpe&quot;&gt;Ladungspumpe&lt;/a&gt; und viele Parameter wie Gate-Serienwiderstände, Überstom-Abschaltung und die integrierten Strommessverstärker lassen sich beim DRV8323 digital über ein SPI-Interface konfigurieren.&lt;/p&gt;

&lt;p&gt;Trotzdem wurde es nicht als nötig erachtet für den DRV8323 Chip eine simple Testplatine zu entwerfen, was sich im Verlauf als Fehlentscheidung herausstellte.&lt;/p&gt;

&lt;p&gt;Nervig wurde die Situation bereits beim Schreiben des &lt;a href=&quot;https://github.com/modm-io/modm/pull/27&quot;&gt;modm.io-Treibers&lt;/a&gt;.
Es ist meist hilfreich mit einem Logic-Analyser oder Oszilloskop de SPI-Bus auf der Platine an Testpunkten abgreifen und beobachten zu können.
Leider passten auf die Platine des Micro-Motors keine Testpunkte, manche der Leiterbahnen waren nicht einmal auf zugänglichen Außenlagen der Platine, sondern ausschließlich unter Chips und auf den Innenlagen geführt.
Somit musste filigraner Fädeldraht an die kleinen Lötperlen an den Außenkanten der QFN/DFN-Pads des Chips anlöten werden um an diesem Fädeldraht dann die Signale mit Logic-Analyser und Oszilloskop ab zugreifen.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/micro-motor-faedeldraht.jpg&quot; alt=&quot;Makro-Aufnahme Micro-Motor Fädeldraht&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dabei wurde das erste Problem recht schnell deutlich: Die MISO-Leitung des DRV8323 ist ungewöhlicherweise als &lt;a href=&quot;https://de.wikipedia.org/wiki/Open-Collector-Ausgang&quot;&gt;Open-Drain&lt;/a&gt; und nicht wie üblich als &lt;a href=&quot;https://de.wikipedia.org/wiki/Gegentaktendstufe&quot;&gt;Push-Pull-Stufe&lt;/a&gt; ausgeführt, infolgedessen wird ein externer Pull-Up-Widerstand benötigt.
Um diesen Widerstand einzusparen sollte der intern zuschaltbare &lt;a href=&quot;https://de.wikipedia.org/wiki/Pull-up-Widerstand&quot;&gt;Pull-Up Widerstand&lt;/a&gt; im STM32 Microcontroller genutzt werden.
Leider ist der Widerstand dieses Pull-Ups (laut Datenblatt 30 Kiloohm bis 70 Kiloohm viel zu groß für die minimal konfigurierbare SPI-Frequenz (mehrere 100kHz) des STM32L433 Microcontrollers.
Folglich musste neben dem Fädeldraht für die Messinstrumente noch ein 10 Kiloohm Pull-Up-Widerstand mit Fädeldraht nachgerüstet werden.
Das Löten war schon fast zur Routine geworden, da sich der Fädeldraht in der Zwischenzeit mehrfach gelöst hatte.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/micro-motor-testaufbau.jpg&quot; alt=&quot;Micro-Motor Testaufbau mit zwei Oszilloskopen und zwei Netzteilen&quot; /&gt;&lt;/p&gt;

&lt;p&gt;In Endeffekt hat die vorhandene Hardware aber ihre Inbetriebnahme und die Software-Entwicklung unter Zusatzaufwand ermöglicht.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/qfn-dfn-pad.jpg&quot; alt=&quot;Makro-Aufnahme: Pad eines DFN/QFN-Chips&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Bis letzte Woche ein merkwürdiges Verhalten der PWM-Waveform bei der Ansteuerung von BLDC-Motoren auftrat.
Zum lokalisieren des Fehlers wurden neben den Signalen an den Motorphasen auch die Signale der Gates vor und nach dem Gatetreiber betrachtet.
Auch diese Signale sind nur an den seitlichen Pads von QFN-Chips ab zugreifen.
Der Pad-Pitch beträgt hier 0,5 mm, also etwa gleich dem Durchmesser des Spitze der Oszilloskop-Probe.
Natürlich rutschte die Spitze ab und verursachte einen Kurzschluss, welcher vom Gatetreiber mit erhöhten Stromverbrauch und Rauchentwicklung quittiert wurde.&lt;/p&gt;

&lt;p&gt;Schnell war die Entscheidung getroffen um weitere Zerstörung zu verhindern nun doch eine Testplatine für den DRV8323-Chip zu konstruieren.&lt;/p&gt;

&lt;p&gt;Da es für den verwendeten Microcontroller kein Entwicklungs-Board vom Hersteller gibt wurde dieser integriert, der Schaltplan ist daher fast identisch mit dem des Micro-Motors.
Die Platinengröße wurde von einem Kreis mit Durchmesser von 20 mm auf ein Rechteck von 100 mm x 33 mm erweitert um Platz für die etwa 50 Testpunkte zu bieten.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../../assets/img/blog/2018/macro-motor-pcb.png&quot; alt=&quot;Macro-Motor Testplatine&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Der Name ist entsprechend auch nicht weit von Micro-Motor entfernt gewählt: &lt;em&gt;Macro-Motor&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Dank der schnellen Platinenfertigung von Aisler reicht eine gute Woche Wartezeit aus, bis die neue Testplatine in unserer Werkstatt liegen wird.&lt;/p&gt;
</description>
            <pubDate>Sat, 06 Oct 2018 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>Saisonstart 2019</title>
            <link>/blog/2018/saisonstart-2019.html</link>
            <guid isPermaLink="true">/blog/2018/saisonstart-2019.html</guid>
            <description>&lt;p&gt;Am letzten Wochenende wurden die Regeln für die kommende Eurobot-Saison erstmals veröffentlicht.
Das Regelwerk ist noch im Beta-Status, kann aber schon auf &lt;a href=&quot;http://www.eurobot.org/eurobot/eurobot-2019/eurobot-2019-rules&quot;&gt;eurobot.org&lt;/a&gt; gelesen werden.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2018/eurobot-2019-field.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wir freuen uns schon auf die kreative Phase in den kommenden Wochen, wenn wir die Konzepte entwickeln und Anfangen Roboter zu konstruieren.&lt;/p&gt;

&lt;h2 id=&quot;mitmachen&quot;&gt;Mitmachen&lt;/h2&gt;

&lt;p&gt;Die nächste Zeit ist ideal zum Einstieg für Interessenten.
Wir haben eine Menge &lt;a href=&quot;http://www.roboterclub.rwth-aachen.de/mach-mit/&quot;&gt;Projekte&lt;/a&gt; für die wir motivierte Studenten suchen, egal in welchem Semester oder Studiengang.&lt;/p&gt;

&lt;p&gt;Wenn wir dein Interesse geweckt haben, komme Dienstag abends bei unserem &lt;a href=&quot;http://www.roboterclub.rwth-aachen.de/kontakt/&quot;&gt;wöchentlichen Meeting&lt;/a&gt; vorbei und lerne uns kennen.&lt;/p&gt;
</description>
            <pubDate>Tue, 18 Sep 2018 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>µMotor</title>
            <link>/blog/2018/micro-motor-motorcontroller.html</link>
            <guid isPermaLink="true">/blog/2018/micro-motor-motorcontroller.html</guid>
            <description>&lt;h2 id=&quot;idee&quot;&gt;Idee&lt;/h2&gt;

&lt;p&gt;Die Idee ist schon älter, aber nun haben wir uns an die Umsetzung gewagt:&lt;br /&gt;
Ein miniaturisierter Motorcontroller, welche dezentral direkt an jeden Motor verbaut wird
und nur an Strom und CAN-Bus angeschlossen werden muss.&lt;/p&gt;

&lt;h2 id=&quot;anforderungen&quot;&gt;Anforderungen&lt;/h2&gt;

&lt;p&gt;Die Anforderungen haben wir in den letzten Jahren gesammelt:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;del&gt;2 Phasen (nur DC Motoren) oder&lt;/del&gt; 3 Phasen (DC und BLDC Motoren)&lt;/li&gt;
  &lt;li&gt;ca. 10A pro Phase&lt;/li&gt;
  &lt;li&gt;20V Betriebsspannung (Akku) -&amp;gt; 40V oder 60V Auslegung&lt;/li&gt;
  &lt;li&gt;Anschluss für Encoder mit AB(I)-Interface&lt;/li&gt;
  &lt;li&gt;optional Magnetencoder auf dem PCB&lt;/li&gt;
  &lt;li&gt;Anschluss für Hall-Sensor&lt;/li&gt;
  &lt;li&gt;Temperatursensor (kontaktlos auf dem PCB verlötet oder I²C)&lt;/li&gt;
  &lt;li&gt;Strommessung&lt;/li&gt;
  &lt;li&gt;LEDs für Software-Status &amp;amp; Encoderstatus&lt;/li&gt;
  &lt;li&gt;Konfigurierbare ID (ggf. STM32-Hardware-ID)&lt;/li&gt;
  &lt;li&gt;Einfach lötbar und aufbaubar&lt;/li&gt;
  &lt;li&gt;Abmessungen: Rund, Grund-Ø 20mm (Namiki-Motoren: Ø 22mm)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;komponentenauswahl&quot;&gt;Komponentenauswahl&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/micro-motor/umotor-pcb.jpg&quot; alt=&quot;Er ist uns beim Waschen leider etwas eingegangen. Funktioniert aber trotzdem noch.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Als nächsten Schritt mussten wir die Komponenten auswählen.
Die Wahl des Mikrocontrollers fiel schnell und wenig überraschen auf einen STM32, konkret einen &lt;a href=&quot;http://www.st.com/en/microcontrollers/stm32l433cc.html&quot;&gt;STM32L433CCU&lt;/a&gt; im 7x7mm²-UFQFPN48 Gehäuse.
Geeignete MOSFETs und MOSFET-Treiber auszuwählen gestaltete sich als deutlich komplizierter.
Eine große Herausforderung ist die kleine Baugröße von nur Ø 20mm.
Recht schnell war klar, dass dies nur realisierbar ist mit Komponenten welche Reflow-Löten erfordern,
somit waren DFN-Gehäuse nicht mehr wie bei früheren Projekten im RCA unerwünscht.&lt;/p&gt;

&lt;p&gt;Das Anschluss ist ein 5-poliger Stecker mit CAN-Bus (2 Pins), Versorgungsspannung (12-40V), Logikspannung zu Versorgung des Controllers und natürlich Ground (GND).
Die Logikspannung ist von der Versorgungsspannung getrennt, da letztere möglicherweise durch Not-Aus-Schaltkreise deaktiviert werden kann, wobei die Controller aktiv bleiben sollen.&lt;/p&gt;

&lt;p&gt;Schlussendlich haben wir nach wochenlanger Recherche den &lt;a href=&quot;http://www.ti.com/product/drv8323&quot;&gt;DRV8323S&lt;/a&gt; von Texas Intruments als MOSFET-Treiber ausgewählt.
Die entscheidenden Merkmale neben dem kompakten 6x6mm²-40WQFN Gehäuse die geringe Anzahl der benötigten externen Widerstände und Kondensatoren sowie das SPI-Interface über welches alle Parameter konfiguriert werden können.
Eines der Parameter ist der Gate-Drive-Strom, dadurch können Widerstände in den Gate-Leitungen zu den MOSFETs entfallen.
Ein weiterer Vorteil ist die Ladungspumpe zur Ansteuerung der High-Side-MOSFETs welche 100% PWM-Dutycycle erlaubt in Kontrast zu Bootstrap-Schaltungen bei Alternativkomponenten.
Mit Shunt-Widerstände in zwei der drei Motor-Phasen, einem Shunt-Widerstand welche den Gesamtstrom misst und den drei integrierten Strom-Messverstärkern des Gatetreibers wird die Strommesssung und eine Cycle-by-Cycle Strombegrenzung realisiert.&lt;/p&gt;

&lt;p&gt;Die Wahl der MOSFETs fiel auf den Typ &lt;a href=&quot;http://www.onsemi.com/PowerSolutions/product.do?id=FDMD8260L&quot;&gt;FDMD8260L&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Zwei n-Channel MOSFETs im 3.3x5mm²-DFN12 Gehäuse&lt;/li&gt;
  &lt;li&gt;V_DS 60V, R_DSon 5.8 mΩ&lt;/li&gt;
  &lt;li&gt;I_D 40A (continuous max.)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Aus der Rückseite befindet sich der Magnetencoder &lt;a href=&quot;https://ams.com/AS5045&quot;&gt;AS5045B&lt;/a&gt; von AMS,
den wir vorher schon alleinstehend verwendet haben.
Falls der Motor einen Encoder mitbringt kann dieser Chip nicht bestückt werden und stattdessen der Motorencoder über Lötpads unterhalb des Magnetencoder-Footprints angelötet werden.
Für externe Motorencoder wurde zus#tzlich ein ansonsten nicht benötigter 5V-Spannungsregler vorgesehen.&lt;/p&gt;

&lt;p&gt;Daneben sind auf der Platine nur ein CAN-Bus-Transceiver (&lt;a href=&quot;http://www.ti.com/product/tcan332&quot;&gt;TCAN332&lt;/a&gt;) und Spannungsregler verbaut,
welche aufgrund der kleinen Bauform ausgewählt wurden.&lt;/p&gt;

&lt;h2 id=&quot;schaltplan-und-layout&quot;&gt;Schaltplan und Layout&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/micro-motor/schematic-overview-screenshot.jpg&quot; alt=&quot;Schaltplanübersicht micro-motor (µMotor) in KiCad&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/micro-motor/pcb-layout-screenshot.jpg&quot; alt=&quot;PCB Layout micro-motor (µMotor) in KiCad&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Aus den Anforderungen und Überlegungen sind in den vergangenen Monaten Schaltpläne und ein kompaktes Platinenlayout entstanden.
Das Platinenlayout ist 4-lagig ausgeführt, anders wäre die geforderte Bauform nicht umsetzbar gewesen.&lt;/p&gt;

&lt;h2 id=&quot;aufbau-und-inbetriebnahme&quot;&gt;Aufbau und Inbetriebnahme&lt;/h2&gt;

&lt;p&gt;Der erste Aufbau mit Reflow-Ofen und die Inbetriebnahme gestalten sich als nicht trivial,
weil es auf der winzigen Platine kaum möglich ist elektrische oder Software- Probleme mit Multimeter, Oszilloskop oder Logicanalyser zu debuggen.
Einige Leitungen sind nur unter Bauteilen und auf den inneren Lagen geführt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/micro-motor/pcb-assembled-before-reflow-onecent.jpg&quot; alt=&quot;micro-motor (µMotor) vor dem Reflow-Löten. Ein-Cent-Münze zum Größenvergleich.&quot; /&gt;
&lt;img src=&quot;/assets/img/blog/micro-motor/reflow-ofen.jpg&quot; alt=&quot;micro-motor (µMotor) im Reflow Ofen&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Der erste und einzige aufgebaute Prototyp funktioniert weitgehend.
der bisher einzige Hardwarefehler konnte mit Hilfe von Fädeldraht und einem zusätzlichen Widerstand behoben werden.&lt;/p&gt;

&lt;h2 id=&quot;software&quot;&gt;Software&lt;/h2&gt;

&lt;p&gt;Die Software auf dem Mikrocontroller wird mit &lt;a href=&quot;http://modm.io/&quot;&gt;modm&lt;/a&gt; entwickelt.
Bisher sind die Hardware-Abstraktion (Board-Support-Package) und einige Testprogramme für die Inbetriebnahme der Hardware fertiggestellt.&lt;/p&gt;

&lt;p&gt;Die Hauptsoftware fehlt noch.&lt;/p&gt;

&lt;p&gt;Auf dem Microcontroller sollen frei konfigurierbare Pid-Regler und ggf. auch “Motor-mit-Endschalter”-Komponenten,
welche den Aktor parametrierbar initialisieren und verfahren können, das Interface nach außen bilden.&lt;/p&gt;

&lt;p&gt;Programiert werden muss der Micro-Motor über den 3D-gedruckten Programieradapter mit Federkontaktstiften.
Der Adapter verfügt außerdem über eine Pin zum abgreifen der UART-Ausgabe zu Debug-Zwecken.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/micro-motor/swd-adapter.jpg&quot; alt=&quot;Programieradapter für den micro-motor (µMotor)&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ausblick&quot;&gt;Ausblick&lt;/h2&gt;

&lt;p&gt;In den nächsten Wochen werden wir die Hardware vollstandig testen, Software implementieren, Messungen vornehmen und Dokumentation schreiben.&lt;/p&gt;

&lt;p&gt;Zeitnah werden wir den Quellcode, Schaltplan, Platinenlayout und mechanische CAD-Modelle unter einer OpenSource Lizenz veröffentlichen.&lt;/p&gt;

&lt;p&gt;To be continued…&lt;/p&gt;
</description>
            <pubDate>Sat, 05 May 2018 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>Saisonstart 2018</title>
            <link>/blog/2017/saisonstart-2018.html</link>
            <guid isPermaLink="true">/blog/2017/saisonstart-2018.html</guid>
            <description>&lt;p&gt;Die Entwicklungsphase für die Saison 2018 ist gestartet.
Dieses Jahr steht der Eurobot unter dem Motto “Robot Cities”.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/robo_antrieb.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Wir haben schonmal einen neuen Allradantrieb konstruiert, hilf uns mit ihn zu bauen.&lt;/p&gt;
</description>
            <pubDate>Mon, 23 Oct 2017 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>We are German champion 2017</title>
            <link>/blog/2017/we-are-german-champion-2017.html</link>
            <guid isPermaLink="true">/blog/2017/we-are-german-champion-2017.html</guid>
            <description>&lt;p&gt;We are qualified for the international contest in France!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2017/PR_Eurobot2017_Siegerfoto_Dresden.jpg&quot; alt=&quot;Eurobot 2017 Siegerfoto Dresden&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Our robots, Juri and Siggi, won nearly every game at the German Eurobot contest 2018 in Dresden.
The competition was well organized by TURAG. Thank you for the great time!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2017/Juri_Siggi_Rooftop_Back.jpg&quot; alt=&quot;Juri Siggi Rooftop Back&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We would like to thank our sponsors and supporters for their generous backing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2017/Juri_Siggi_Rooftop_Front.jpg&quot; alt=&quot;Juri Siggi Rooftop Front&quot; /&gt;&lt;/p&gt;
</description>
            <pubDate>Mon, 01 May 2017 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>We are German champion 2016</title>
            <link>/blog/2016/we-are-german-champion-2016.html</link>
            <guid isPermaLink="true">/blog/2016/we-are-german-champion-2016.html</guid>
            <description>&lt;p&gt;We are qualified for the international contest in France!
Our robots, Hassel and Hoff, won every game at the German Eurobot contest 2016 in Stuttgart.&lt;/p&gt;

&lt;p&gt;The competition was well organized by VtAS. Thank you for the great time!&lt;/p&gt;

&lt;p&gt;We would like to thank our sponsors for their generous support.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2016/Foto2016StuttgartCropped.jpg&quot; alt=&quot;RCA in Stuttgart 2016&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2016/2016HasselHoff.jpg&quot; alt=&quot;Roboter Hassel und Hoff&quot; /&gt;&lt;/p&gt;
</description>
            <pubDate>Tue, 03 May 2016 00:00:00 +0000</pubDate>
        </item>
        
        <item>
            <title>The Rules for Eurobot 2016 are published</title>
            <link>/blog/2015/rules-eurobot-2016.html</link>
            <guid isPermaLink="true">/blog/2015/rules-eurobot-2016.html</guid>
            <description>&lt;p&gt;The new theme for Eurobot 2016 is “The Beach Bots”. There are many actions for the Robots to do and many parts to move. We are already brainstorming and looking forward to exiting games.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/blog/2016/phobos_in_castle.jpg&quot; alt=&quot;Phobos in castle&quot; /&gt;&lt;/p&gt;
</description>
            <pubDate>Tue, 20 Oct 2015 00:00:00 +0000</pubDate>
        </item>
        
    </channel>
</rss>